# 第九章－推荐系统

         如果有数据，那数据说了算。如果没有，那么我说了算。

                                                                                                          －前 Netscape CEO Jim Barksdale

## 推荐系统是什么？

        推荐系统也被称为，推荐引擎。它是一种信息系统，主要用来将物品或者动作显示或者推荐给用户。推荐物品通常由少量的物品－电影，书籍，等等，比如：社交网络中的关注其他用户的推荐。从大的集合中根据一些条件，比如，用户之前表现出来的喜好，来选择出一个小的子集，就是一种很典型的做法。其他可能的条件包括：年龄、性别、和位置。

        以下是推荐系统中常用的几种方法：

* **内容过滤**

        内容过滤通过收集辅助信息（比如，用户的人口统计数据，音乐流派，关键词，问卷答案）来为每个物品或者用户来生成一个画像。基于用户画像来匹配物品。例如：Pandora的Music Genome项目。

* **协同过滤**

        协同过滤是基于用户的过去行为。每个用户的排名，或者浏览记录可以让推荐系统在拥有相同行为用户和相同用户之间的物品兴趣之间建立联系。比如：Netflix。

        协同过滤，得益于它天然的领域开放性，成为了这几种方法中的可能最流行的方法。在协同过滤系统还可以通过基于邻近的方法（基于用户与用户的距离，或者物品与物品的距离）、因子、降维模型－可以用来自动发现用户或者物品的少量描述因子，来进一步划分。低阶矩阵因子分解是降维模型的最著名的方法，同时它也是推荐系统内部最灵活和成功的方法之一。矩阵分解有很多种变体，包括，可能性和贝叶斯版本。另一种目前最先进的方法是一种深度学习神经网络，受限波尔兹曼机。

## 推荐系统有什么用途？

         推荐系统的应用十分广泛，它可以应用到任何面向海量用户的多种类商品种销售的商业中。零售商，比如：Amazon，Netflix 以及 Target ，网络电影和音乐，比如：Netflix 和 last.fm , 以及社交网站，比如： Facebook 和 Twitter, 都采用了推荐系统。推荐系统也被应用到杂货店，比如：Tesco。

         除了上面提及的，零售，媒体，以及社交网站的例子外，推荐系统也被，诸如：Yahoo!，Google，这样的通用网站用基于历史浏览和其他信息来推送最好的广告。推荐系统另外一个应用是在市场决策方面的类似下一个最佳购物建议的应用，例如：Schwan 食品公司就利用推荐系统来提高他们冷冻食品的销量。

![&#x56FE; 9.1  &#x77E9;&#x9635;&#x56E0;&#x5B50;&#x5206;&#x89E3;](../../.gitbook/assets/image.png)

## 推荐系统如何工作？

　　我们将会对大多数的推荐系统的底层的基本数学原理进行讲解。首先，我们假设，有一个 $$N_u$$ 行 $$N_i$$ 列的排名矩阵 $$X$$ ，其中， $$N_u$$ 代表用户的数量， $$N_i$$ 代表要被排名的物品的数量。 $$X$$ 中的元素$$x_{ui}$$ 代表给用户 $$u$$ 推荐的物品 $$i$$ 的排名。我们往往只知道矩阵 $$X$$ 中的少量元素。假设， 已知的排名以类似： $$(u_1,i_i,x_{u_i,i_i})...(u_n,i_n,x_{u_n,i_n})$$的三元组， 如图9.1所示的方式存储。我们假设已有的排名有 $$n$$ 个。

### 基本模型

　　推荐系统的基本模型可以定义为：

$$
x_{ui}=b_0+b_u+b_i
$$

其中， $$b_0$$， $$b_u$$ ， $$b_i$$  分别为常量， 用户的偏差，物品的偏差。 $$b_0$$ 对应全局平均排名， 而$$b_u$$ 代表用户 $$u$$ 从 $$b_0$$ 开始的平均偏差总数， $$b_i$$ 代表物品 $$i$$ 从 $$b_0$$ 开始的平均偏差总数。模型的目标是对集合 $$D$$ 中所有的 $$u$$ 和 $$i$$ ，估计 $$b_0$$, $$b_u$$和 $$b_i$$ 。

          偏差可以通过解决最小二乘法优化问题来估计。

$$
\min\limits_{b_u,b_i} \sum\limits_{(u,i) \in D} (x_{ui} - b_0 - b_u - b_i)^2+\lambda\lgroup \sum\limits_ub_u^2 + \sum\limits_ib_i^2\rgroup
$$

其中 $$b_0$$ 为所有已知 $$x_{ui}$$ 的平均值，第一个子式是模型的观察排名和预测排名的平方误差。  第二个子式是归一化补偿来降低过度拟合时造成的大误差的影响。参数 $$\lambda$$ 来控制归一化的总值。

![&#x8868; 9.1 &#x5DF2;&#x77E5;&#x6392;&#x540D;&#x7684;&#x6570;&#x636E;&#x96C6;D](../../.gitbook/assets/1947a69e-08a7-4590-a540-e4261a7cce10.jpeg)

## 低阶矩阵因子分解

       低阶矩阵因子分解提供了一种更加灵活的模型。考虑如下的内积：

$$
x_{ui} = I_u \times r_i
$$

其中 $$I_u$$ 和 $$r_i$$ 都是一个 $$K$$ 维矢量。上面的模型也可以改写为矩阵乘积的形式。

$$
X = LR
$$

如图9.1所述，等式左边的因子矩阵 $$L$$ 的行由所有用户的 $$l_u$$ 矢量组成，右边的因子矩阵 $$R$$ 的列由所有物品的 $$r_i$$ 矢量组成。在这个模型中，正如模型名—低阶矩阵因子分解而言，矩阵 $$X$$ 的阶 $$K$$ 远远比 $$N_u$$ 和 $$N_i$$ 要小。

 与基础模型类似，$$L $$和 $$R$$ 的估计可以通过解决如下的优化问题来得到：

$$
\min\limits_{l_u,r_i} \sum\limits_{(u,i) \in D} (x_{ui} - l_ux_i)^2 + \lambda\lgroup\sum_u \parallel l_u\parallel^2 + \sum_i \parallel r_i\parallel^2\rgroup
$$



